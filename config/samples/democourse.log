apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"batch/v1","kind":"Job","metadata":{"annotations":{},"labels":{"app.kubernetes.io/component":"job","app.kubernetes.io/name":"cms-job-20210316102133"},"name":"cms-job-20210316102133","namespace":"openedx"},"spec":{"backoffLimit":1,"template":{"spec":{"containers":[{"args":["sh","-e","-c","echo \"Loading settings $DJANGO_SETTINGS_MODULE\"\n\n# Import demo course\ngit clone https://github.com/edx/edx-demo-course --branch open-release/koa.2 --depth 1 ../edx-demo-course\npython ./manage.py cms import ../data ../edx-demo-course\n\n# Re-index courses\n./manage.py cms reindex_course --all --setup"],"env":[{"name":"SERVICE_VARIANT","value":"cms"}],"image":"docker.io/overhangio/openedx:11.2.3","name":"cms","volumeMounts":[{"mountPath":"/openedx/edx-platform/lms/envs/tutor/","name":"settings-lms"},{"mountPath":"/openedx/edx-platform/cms/envs/tutor/","name":"settings-cms"},{"mountPath":"/openedx/config","name":"config"}]}],"restartPolicy":"Never","volumes":[{"configMap":{"name":"openedx-settings-lms"},"name":"settings-lms"},{"configMap":{"name":"openedx-settings-cms"},"name":"settings-cms"},{"configMap":{"name":"openedx-config"},"name":"config"}]}},"ttlSecondsAfterFinished":3600}}
  creationTimestamp: "2021-03-16T14:35:04Z"
  labels:
    app.kubernetes.io/component: job
    app.kubernetes.io/name: cms-job-20210316102133
  managedFields:
  - apiVersion: batch/v1
    fieldsType: FieldsV1
    fieldsV1:
      f:metadata:
        f:annotations:
          .: {}
          f:kubectl.kubernetes.io/last-applied-configuration: {}
        f:labels:
          .: {}
          f:app.kubernetes.io/component: {}
          f:app.kubernetes.io/name: {}
      f:spec:
        f:backoffLimit: {}
        f:completions: {}
        f:parallelism: {}
        f:template:
          f:spec:
            f:containers:
              k:{"name":"cms"}:
                .: {}
                f:args: {}
                f:env:
                  .: {}
                  k:{"name":"SERVICE_VARIANT"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                f:image: {}
                f:imagePullPolicy: {}
                f:name: {}
                f:resources: {}
                f:terminationMessagePath: {}
                f:terminationMessagePolicy: {}
                f:volumeMounts:
                  .: {}
                  k:{"mountPath":"/openedx/config"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                  k:{"mountPath":"/openedx/edx-platform/cms/envs/tutor/"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                  k:{"mountPath":"/openedx/edx-platform/lms/envs/tutor/"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
            f:dnsPolicy: {}
            f:restartPolicy: {}
            f:schedulerName: {}
            f:securityContext: {}
            f:terminationGracePeriodSeconds: {}
            f:volumes:
              .: {}
              k:{"name":"config"}:
                .: {}
                f:configMap:
                  .: {}
                  f:defaultMode: {}
                  f:name: {}
                f:name: {}
              k:{"name":"settings-cms"}:
                .: {}
                f:configMap:
                  .: {}
                  f:defaultMode: {}
                  f:name: {}
                f:name: {}
              k:{"name":"settings-lms"}:
                .: {}
                f:configMap:
                  .: {}
                  f:defaultMode: {}
                  f:name: {}
                f:name: {}
        f:ttlSecondsAfterFinished: {}
    manager: oc
    operation: Update
    time: "2021-03-16T14:35:04Z"
  - apiVersion: batch/v1
    fieldsType: FieldsV1
    fieldsV1:
      f:status:
        f:completionTime: {}
        f:conditions:
          .: {}
          k:{"type":"Complete"}:
            .: {}
            f:lastProbeTime: {}
            f:lastTransitionTime: {}
            f:status: {}
            f:type: {}
        f:startTime: {}
        f:succeeded: {}
    manager: kube-controller-manager
    operation: Update
    time: "2021-03-16T14:35:41Z"
  name: cms-job-20210316102133
  namespace: openedx
  resourceVersion: "95220582"
  selfLink: /apis/batch/v1/namespaces/openedx/jobs/cms-job-20210316102133
  uid: 15790f66-ed4b-4c41-a039-88f4882f4840
spec:
  backoffLimit: 1
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      controller-uid: 15790f66-ed4b-4c41-a039-88f4882f4840
  template:
    metadata:
      creationTimestamp: null
      labels:
        controller-uid: 15790f66-ed4b-4c41-a039-88f4882f4840
        job-name: cms-job-20210316102133
    spec:
      containers:
      - args:
        - sh
        - -e
        - -c
        - |-
          echo "Loading settings $DJANGO_SETTINGS_MODULE"

          # Import demo course
          git clone https://github.com/edx/edx-demo-course --branch open-release/koa.2 --depth 1 ../edx-demo-course
          python ./manage.py cms import ../data ../edx-demo-course

          # Re-index courses
          ./manage.py cms reindex_course --all --setup
        env:
        - name: SERVICE_VARIANT
          value: cms
        image: docker.io/overhangio/openedx:11.2.3
        imagePullPolicy: IfNotPresent
        name: cms
        resources: {}
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /openedx/edx-platform/lms/envs/tutor/
          name: settings-lms
        - mountPath: /openedx/edx-platform/cms/envs/tutor/
          name: settings-cms
        - mountPath: /openedx/config
          name: config
      dnsPolicy: ClusterFirst
      restartPolicy: Never
      schedulerName: default-scheduler
      securityContext: {}
      terminationGracePeriodSeconds: 30
      volumes:
      - configMap:
          defaultMode: 420
          name: openedx-settings-lms
        name: settings-lms
      - configMap:
          defaultMode: 420
          name: openedx-settings-cms
        name: settings-cms
      - configMap:
          defaultMode: 420
          name: openedx-config
        name: config
status:
  completionTime: "2021-03-16T14:35:41Z"
  conditions:
  - lastProbeTime: "2021-03-16T14:35:41Z"
    lastTransitionTime: "2021-03-16T14:35:41Z"
    status: "True"
    type: Complete
  startTime: "2021-03-16T14:35:04Z"
  succeeded: 1
